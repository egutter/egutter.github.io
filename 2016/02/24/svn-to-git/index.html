<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no"/>
  <title>svn to git</title>
  <link href="https://egutter.github.io/prueba-blog/css/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"/>
  <link href="https://egutter.github.io/prueba-blog/css/style.css" type="text/css" rel="stylesheet" media="screen,projection"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/styles/default.min.css">
  <style type="text/css">
  
    footer.page-footer{background-image: url(https://egutter.github.io/prueba-blog/images/default.png);}
  
  </style>
</head>
<body>
  <ul id="slide-out" class="side-nav">
    <li><a href="https://egutter.github.io/prueba-blog"><i class="mdi-action-home left"></i>Home<i class="mdi-hardware-keyboard-arrow-right right"></i></a></li>
    <li><a href="https://egutter.github.io/prueba-blog/categories"><i class="mdi-action-perm-media left"></i>Categories<i class="mdi-hardware-keyboard-arrow-right right"></i></a></li>
    <li><a href="https://egutter.github.io/prueba-blog/tags"><i class="mdi-action-loyalty left"></i>Tags<i class="mdi-hardware-keyboard-arrow-right right"></i></a></li>
  </ul>
  <div id="index-banner" class="parallax-container">
  <a data-activates="slide-out" class="btn-floating button-collapse" style="top: 5px; left: 5px;"><i class="mdi-navigation-menu"></i></a>
    <div class="section no-pad-bot">
      <div class="container">
        
        <h1 class="header center teal-text text-lighten-2">10 Pines Blog</h1>
        <div class="row center">
          <h5 class="header col s12 light"></h5>
        </div>
        <div class="row center">
        
        
        
          <a href="https://www.facebook.com/10Pines"><img src="https://egutter.github.io/prueba-blog/images/facebook-dreamstale25.png"></a>
        
        
        
        
          <a href="https://www.linkedin.com/in/10Pines"><img src="https://egutter.github.io/prueba-blog/images/linkedin-dreamstale45.png"></a>
        
          <a href="https://egutter.github.io/prueba-blog/index.xml"><img src="https://egutter.github.io/prueba-blog/images/feed-dreamstale27.png"></a>
        </div>
      </div>
    </div>
    <div class="parallax">
    
      <img src="https://egutter.github.io/prueba-blog//images/10pines-background.jpg">
    
    </div>
  </div>



<div class="container">
  <div class="section">

    <div class="row">
      <div class="col s12">
        <div class="card-panel">
          <h4>svn to git</h4>
          <p>
          
            
              <a href="https://egutter.github.io/prueba-blog/categories/git/">git</a>
            
              <a href="https://egutter.github.io/prueba-blog/categories/svn/">svn</a>
            
              <a href="https://egutter.github.io/prueba-blog/categories/github/">github</a>
            
           
          </p>
          <p>

<h1 id="svn-to-git-full-migration">Svn to git, full migration</h1>

<p>Finally you decided that git is more suitable than svn for your work. But, what happens when you have projects that where using svn for a while?
All of that information represented in thousand of svn revisions is something that normally you don&rsquo;t want to lose. For these cases I wrote this step by step guide to successfully migrate all the history stored in svn on a git repository, included all branches and tags no matter svn repository size. The only drawback is, more revisions you have more time you need to wait to get migration finished.</p>

<h1 id="step-by-step">Step by step</h1>

<p>To start the migration process, you need some info about how is data organized in your svn.</p>

<h2 id="layout-of-directories-inside-svn">Layout of directories inside svn</h2>

<p>If you are lucky your project follows this directories layout</p>

<ul>
<li>a/path/projectname

<ul>
<li>trunk</li>
<li>branches</li>
<li>tags</li>
</ul></li>
</ul>

<p>This can be simply informed to git-svn with -s or &ndash;stdlayout. If is not your case you have to inform to git-svn where is every one of these tree directories.</p>

<pre><code>-T trunkSubdirecty or --trunk=trunkSubdirecty
-t tagsSubdirecty or --tags=tagsSubdirecty
-b brenchesSubdirecty or --branches=brenchesSubdirecty
</code></pre>

<p>For example you can have a layout like this</p>

<ul>
<li>a/path

<ul>
<li>trunk

<ul>
<li>projectname1</li>
<li>projectname2</li>
</ul></li>
<li>branches

<ul>
<li>projectname1</li>
<li>projectname2</li>
</ul></li>
<li>tags

<ul>
<li>projectname1</li>
<li>projectname2</li>
</ul></li>
</ul></li>
</ul>

<p>If you are migrating projectname1 the arguments must look like this</p>

<pre><code>-T trunk/projectname1 -t tags/projectname1 -b branches/projectname1
</code></pre>

<h2 id="first-svn-revision-where-git-history-will-start">First svn revision where git history will start</h2>

<p>The other thing you need to know is the revision number where start the history of what you want to migrate. First candidate is first revision number where your project exists. You can ask svn by running this line.</p>

<pre><code>svn log -r 1:HEAD --limit 1 svnrepourl/a/path/trunkSubdirectory
</code></pre>

<p>If you want to truncate some of the old history simply choose a newer revision number.</p>

<h2 id="creating-git-repository">Creating git repository</h2>

<p>Standar</p>

<pre><code>git svn clone --username=yourSvnUsername --stdlayout -r aRevisionNumber svnurl/a/path/projectname gitreponame
</code></pre>

<p>Custom layout</p>

<pre><code>git svn clone --username=yourSvnUsername -T trunk/projectname -t tags/projectname -b branches/projectname -r aRevisionNumber svnurl/a/path/projectname gitreponame
</code></pre>

<h2 id="fetching-data-from-svn">Fetching data from svn</h2>

<pre><code>cd gitreponame
git svn fetch
</code></pre>

<p>This step could last long time even days depending the amount of revisions, data transfer ratios and from my experience, if you use windows takes more time than linux or osx. Git-svn will perform one request per revision to svn and will create a git commit if it considered convenient. If something goes wrong during data fetching, you simply run again &ldquo;git svn fetch&rdquo; and work will resume from last svn revision successfully processed. That&rsquo;s the reason why you must use &ldquo;git clone -r n&rdquo; and then &ldquo;git svn fetch&rdquo;.
When you run &ldquo;git svn fetch&rdquo; and finish with nothing to log it minds you finished the hardest part, now you have all data in your local git repository. But to finish your work you need to put all this information in github, bitbucket, your intranet git repositories container or where you consider useful.</p>

<h1 id="preparing-local-repository-to-push-to-an-external-repository">Preparing local repository to push to an external repository</h1>

<h2 id="updating-master-branch">Updating master branch</h2>

<p>Run this line</p>

<pre><code>git svn rebase
</code></pre>

<p>This has the same effect of</p>

<pre><code>git reset --hard origin/trunk
</code></pre>

<p>but have the advantage of confirming you that origin/trunk is already updated with the last svn revision</p>

<h2 id="adding-svn-branches-to-local-repository">Adding svn branches to local repository</h2>

<p>Regarding branches in git, are references to commit-objects inside git database you can simply copy those references that git-svn made.</p>

<pre><code>cp .git/refs/remotes/origin/* .git/refs/heads/
</code></pre>

<p>If you run</p>

<pre><code>git branch
</code></pre>

<p>You will see all branches that exists in svn including trunk</p>

<h2 id="adding-svn-tags-as-git-tags-on-local-repository">Adding svn tags as git tags on local repository</h2>

<p>Tags in git are different than branches, tag references point to tag-objects inside git database. The references that git-svn created are references that point to commit-objects instead of tag-objects, then they are branches instead of tags. Well, lets create a tag for every references that git-svn have created inside .git/refs/remotes/origin/tags.
Just run this line, if you are using windows you have to run it inside git bash console</p>

<pre><code>git for-each-ref refs/remotes/origin/tags | sed 's#^.*\([[:xdigit:]]\{40\}\).*refs/remotes/origin/tags/\(.*\)$#\2 \1#g' | while read p; do git tag -m &quot;tag from svn&quot; $p; done
</code></pre>

<p>If you run</p>

<pre><code>git tag
</code></pre>

<p>You will see the same list of tags that exists in svn</p>

<h1 id="pushing-data">Pushing data</h1>

<p>Create an empty repository in your repositories container, for example github. Then in your local repository add remote and push.</p>

<pre><code>git remotes add newrepo git@github.com:aUser/aProjectName.git
git push newrepo refs/heads/*
git push --tags newrepo
</code></pre>

<h1 id="say-goodbye-to-svn">Say goodbye to svn</h1>

<p>At this point you can forget that your project once was using svn.</p>
</p>
          <p>24 Feb 2016
            
          </p>
          
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col s3 m1">
      
        <a class="btn-floating btn-large waves-effect waves-light" href="https://egutter.github.io/prueba-blog/2016/07/11/a-little-bit-of-color/"><i class="mdi-navigation-arrow-back"></i></a>
      
      </div>
      <div class="col s6 m10 center">&nbsp</div>
      <div class="col s3 m1">
      
        <a class="btn-floating btn-large waves-effect waves-light" href="https://egutter.github.io/prueba-blog/2016/02/17/how-what-why-the-three-essences-of-software-development/"><i class="mdi-navigation-arrow-forward"></i></a>
      
      </div>
    </div>

  </div>
</div>

  <footer class="page-footer">
    <div class="footer-copyright">
      <div class="container">
      
      <div class="right">Design <a class="grey-text text-lighten-4" href="http://pdevty.github.io/blog/">pdevty</a></div>
      </div>
    </div>
  </footer>
  <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
  <script src="https://egutter.github.io/prueba-blog/js/materialize.min.js"></script>
  <script src="https://egutter.github.io/prueba-blog/js/init.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  

  </body>
</html>

