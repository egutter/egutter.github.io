<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no"/>
  <title>deploy ruby on rails on windows 2008 server and iis 7.0</title>
  <link href="https://egutter.github.io/prueba-blog/css/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"/>
  <link href="https://egutter.github.io/prueba-blog/css/style.css" type="text/css" rel="stylesheet" media="screen,projection"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/styles/default.min.css">
  <style type="text/css">
  
    footer.page-footer{background-image: url(https://egutter.github.io/prueba-blog/images/default.png);}
  
  </style>
</head>
<body>
  <ul id="slide-out" class="side-nav">
    <li><a href="https://egutter.github.io/prueba-blog"><i class="mdi-action-home left"></i>Home<i class="mdi-hardware-keyboard-arrow-right right"></i></a></li>
    <li><a href="https://egutter.github.io/prueba-blog/categories"><i class="mdi-action-perm-media left"></i>Categories<i class="mdi-hardware-keyboard-arrow-right right"></i></a></li>
    <li><a href="https://egutter.github.io/prueba-blog/tags"><i class="mdi-action-loyalty left"></i>Tags<i class="mdi-hardware-keyboard-arrow-right right"></i></a></li>
  </ul>
  <div id="index-banner" class="parallax-container">
  <a data-activates="slide-out" class="btn-floating button-collapse" style="top: 5px; left: 5px;"><i class="mdi-navigation-menu"></i></a>
    <div class="section no-pad-bot">
      <div class="container">
        
        <h1 class="header center teal-text text-lighten-2">10 Pines Blog</h1>
        <div class="row center">
          <h5 class="header col s12 light"></h5>
        </div>
        <div class="row center">
        
        
        
          <a href="https://www.facebook.com/10Pines"><img src="https://egutter.github.io/prueba-blog/images/facebook-dreamstale25.png"></a>
        
        
        
        
          <a href="https://www.linkedin.com/in/10Pines"><img src="https://egutter.github.io/prueba-blog/images/linkedin-dreamstale45.png"></a>
        
          <a href="https://egutter.github.io/prueba-blog/index.xml"><img src="https://egutter.github.io/prueba-blog/images/feed-dreamstale27.png"></a>
        </div>
      </div>
    </div>
    <div class="parallax">
    
      <img src="https://egutter.github.io/prueba-blog//images/10pines-background.jpg">
    
    </div>
  </div>



<div class="container">
  <div class="section">

    <div class="row">
      <div class="col s12">
        <div class="card-panel">
          <h4>deploy ruby on rails on windows 2008 server and iis 7.0</h4>
          <p>
          
            
              <a href="https://egutter.github.io/prueba-blog/categories/rails/">rails</a>
            
              <a href="https://egutter.github.io/prueba-blog/categories/windows/">windows</a>
            
              <a href="https://egutter.github.io/prueba-blog/categories/iis/">iis</a>
            
           
          </p>
          <p><p>Deploying Ruby On Rails in a Windows environment can be very painful. I couldn&rsquo;t find any blog which really helped me, so I decided to summarize all the necessary steps I followed to successfully deploy a Rails application in a Windows 2008 server from scratch. I won&rsquo;t give much explanation on each step, so if you like to know more about it, at the end of this post you&rsquo;ll find a list of articles I found useful.</p>

<p>**The environment: **</p>

<ul>
<li>Windows 2008 SP2 x64</li>
<li>SQL Server 2005</li>
<li>IIS 7.0</li>
<li>Ruby 1.8.7</li>
<li>Ruby on Rails 2.3.5</li>
<li>Mongrel 1.1.5</li>
</ul>

<p><strong>Steps:</strong></p>

<ol>
<li>Install Ruby VM</li>
<li>Install Rails: <code>gem install rails -v '= 2.3.5' --include-dependencies</code></li>
<li>Install any other dependencies your application requires</li>
<li>Install SQL Server adapter: <code>gem install activerecord-sqlserver-adapter --version 2.3.5</code></li>
<li>Install ruby-odbc
a. Download ruby-odbc
b. Copy the zip&rsquo;s content to <code>${RUBY_INSTALLATION_DIR}\lib\ruby\site_ruby\1.8\i386-msvcrt</code></li>
<li>Open the ODBC Data Source Administrator with the command <code>C:\Windows&gt;SysWOW64\odbcad32.exe</code> (make sure you use this command instead of using the regular access from the control panel)</li>
<li>Create a System DSN using your specific database connection properties</li>
<li>Open the command prompt and go to the Rails application root folder</li>
<li>Create and initialize your database:

<ul>
<li><code>rake db:create RAILS_ENV=production</code></li>
<li><code>rake db:migrate RAILS_ENV=production</code></li>
<li><code>rake db:seed RAILS_ENV=production</code></li>
</ul></li>
<li>Install IIS Application Request Routing and URL Rewrite extensions
Edit the hosts file located at <code>C:\Windows\System32\drivers\etc\hosts</code> and add the following line <code>127.0.0.1 localhost localhost-1 localhost-2</code> (add as many localhost-x hostnames as mongrel services you&rsquo;re planning to setup)</li>
<li>Open IIS Manager and create a new farm. Add one server for each of the mongrel services you&rsquo;re planning to setup. For each server use a different address (i.e. localhost-1, localhost-2, etc.) and a different port number (i.e. 3000, 3001, etc.)</li>
<li>Edit URL Rewrite rules and add the following rules
<strong>Rule 1</strong>

<ul>
<li>Pattern: ^$</li>
<li>Action: Route to Server Farm</li>
<li>Path: /main/index</li>
<li>Check stop processing subsequent rules</li>
</ul></li>
</ol>

<p><strong>Rule 2</strong>
 * Pattern:^([^.]+)$
 * Action: Route to Server Farm
 * Path: /{R:1}
 * Do not check stop processing subsequent rules
13. In the IIS Manager create a new Web Site and in the Path box, type or browse to the directory that contains your Rails public folder.
14. Download this win32 services gem and install it.
15. Download this mongrel-service gem and install it.
16. Setup as many mongrel services as you need</p>

<pre><code>mongrel_rails service::install -N my-app-node-1 -e production -p 3000
mongrel_rails service::install -N my-app-node-2 -e production -p 3001
etc..
</code></pre>

<ol>
<li><p>Launch the Window Services console from Control Panel. Change the startup type of your mongrel services to Automatic and start each of them.</p></li>

<li><p>Open a browser and test your application</p></li>
</ol>

<p><strong>Finally, some articles you might find useful:</strong></p>

<p><a href="http://www.ch-werner.de/rubyodbc/">ODBC binding for Ruby</a></p>

<p><a href="http://www.boche.net/blog/index.php/2009/11/21/create-a-32-bit-vcenter-dsn-on-a-64-bit-operating-system/">Create a 32bit DSN on a 64bit operating system</a></p>

<p><a href="http://ruslany.net/2008/08/ruby-on-rails-in-iis-70-with-url-rewriter/">Ruby on Rails in IIS70 with url rewriter</a></p>

<p><a href="http://learn.iis.net/page.aspx/485/define-and-configure-an-application-request-routing-server-farm/">Define and configure an application request routing server farm</a></p>

<p><a href="http://learn.iis.net/page.aspx/461/creating-rewrite-rules-for-the-url-rewrite-module/">Creating rewrite rules for the url rewrite module</a></p>

<p><a href="http://mvolo.com/blogs/serverside/archive/2007/02/18/10-steps-to-get-Ruby-on-Rails-running-on-Windows-with-IIS-FastCGI.aspx">10 steps to get Ruby on Rails running on Windows with IIS FastCGI</a></p>
</p>
          <p>19 Oct 2010
            
          </p>
          
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col s3 m1">
      
        <a class="btn-floating btn-large waves-effect waves-light" href="https://egutter.github.io/prueba-blog/2010/10/22/agiles-2010-story-mapping-un-enfoque-visual-a-la-construccion-del-product-backlog/"><i class="mdi-navigation-arrow-back"></i></a>
      
      </div>
      <div class="col s6 m10 center">&nbsp</div>
      <div class="col s3 m1">
      
        <a class="btn-floating btn-large waves-effect waves-light" href="https://egutter.github.io/prueba-blog/2010/10/13/presentacion-agiles-automatizacion-del-deployment/"><i class="mdi-navigation-arrow-forward"></i></a>
      
      </div>
    </div>

  </div>
</div>

  <footer class="page-footer">
    <div class="footer-copyright">
      <div class="container">
      
      <div class="right">Design <a class="grey-text text-lighten-4" href="http://pdevty.github.io/blog/">pdevty</a></div>
      </div>
    </div>
  </footer>
  <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
  <script src="https://egutter.github.io/prueba-blog/js/materialize.min.js"></script>
  <script src="https://egutter.github.io/prueba-blog/js/init.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  

  </body>
</html>

